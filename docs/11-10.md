<link rel="stylesheet" href="../extra/ideal-image-slider.css">
<link rel="stylesheet" href="../extra/ideal-default-theme.css">
<script src="../extra/ideal-image-slider.js"></script>
<script src="../extra/ideal-iis-bullet-nav.js"></script>
<script>
let gitbook = gitbook || [];
gitbook.push(function() {
    let slider = new IdealImageSlider.Slider('.IdealImageSlider');
    slider.addBulletNav();
});
</script>

### 第十章 - 系统IO

#### 参考资料
1. 内核函数调用表，[Searchable Linux Syscall Table for x86_64](https://filippo.io/linux-syscall-table/)

#### 读写
1. ssize_t read(int fd, void *buf, size_t n);
  * 返回：若成功则为读的字节数，若 EOF 则为0，若出错为 -1。
1. ssize_t write(int fd, const void *buf, size_t n);
  * 返回：若成功则为写的字节数，若出错则为 -1。
1. 不足值：read 和 write 传送的字节比应用程序要求的要少。一般有三种情况：
  * 读时遇到 EOF：一般是读文件读到了文件尾
  * 从终端读文本行：read 函数将一次传送一个文本行，不足值等于文本行的大小
  * 读和写网络套接字：由于内部缓冲约束、网络延迟而出现不足值

#### errno是EINTR的处理
1. [linux中对errno是EINTR的处理](https://www.cnblogs.com/jack-hzm/p/10829324.html)
1. 慢系统调用：那些可能永远阻塞的系统调用。
1. EINTR错误的产生：当某系统调用捕获到某个信号且处理完返回时，该系统调用可能返回一个EINTR错误。
1. 慢系统调用之后需要判断errno=EINTR，然后重新执行该系统调用，即重启
1. accept、read、write、select、和open之类的函数是可以进行重启的。

#### RIO包处理读写
1. RIO 提供了两类不同的函数：
  * 无缓冲的输入输出函数：处理不足值、处理EINTR错误
  * 带缓冲的输入函数